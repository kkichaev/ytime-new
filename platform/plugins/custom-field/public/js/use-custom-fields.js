(()=>{"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function i(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e){var a=function(e,a){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,a||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==t(a)?a:a+""}e.d=(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var l=function(){return i((function e(){a(this,e)}),null,[{key:"wysiwyg",value:function(e,t){window.initializedEditor=window.initializedEditor||0;var a="ckeditor";"undefined"!=typeof tinymce&&(a="tinymce"),e.each((function(e,t){var r=$(t);r.attr("id","editor_initialized_"+window.initializedEditor),window.initializedEditor++,setTimeout((function(){(new EditorManagement).initEditor(r,{},a)}),100)}))}},{key:"wysiwygGetContent",value:function(e){return"undefined"!=typeof CKEDITOR?CKEDITOR[e.attr("id")].getData():"undefined"!=typeof tinymce?tinymce.editors[e.attr("id")].getContent():e.val()}},{key:"arrayGet",value:function(e,t){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{a=e[t]}catch(e){return r}return null==a&&(a=r),a}},{key:"jsonEncode",value:function(e){return void 0===e&&(e=null),JSON.stringify(e)}},{key:"jsonDecode",value:function(e,t){if("string"==typeof e){var a;try{a=$.parseJSON(e)}catch(e){a=t}return a}return null}}])}(),o=function(){return i((function e(){a(this,e),this.$body=$("body"),this.$_UPDATE_TO=$("#custom_fields_container"),this.$_EXPORT_TO=$("#custom_fields_json"),this.CURRENT_DATA=l.jsonDecode(this.base64Helper().decode(this.$_EXPORT_TO.text()),[]),this.CURRENT_DATA&&(this.handleCustomFields(),this.exportData())}),[{key:"base64Helper",value:function(){if(!this.base64){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var a,r,i,n,l,o,c,d="",u=0;for(t=e._utf8_encode(t);u<t.length;)n=(a=t.charCodeAt(u++))>>2,l=(3&a)<<4|(r=t.charCodeAt(u++))>>4,o=(15&r)<<2|(i=t.charCodeAt(u++))>>6,c=63&i,isNaN(r)?o=c=64:isNaN(i)&&(c=64),d=d+this._keyStr.charAt(n)+this._keyStr.charAt(l)+this._keyStr.charAt(o)+this._keyStr.charAt(c);return d},decode:function(t){var a,r,i,n,l,o,c="",d=0;for(t=t.replace(/[^A-Za-z0-9+/=]/g,"");d<t.length;)a=this._keyStr.indexOf(t.charAt(d++))<<2|(n=this._keyStr.indexOf(t.charAt(d++)))>>4,r=(15&n)<<4|(l=this._keyStr.indexOf(t.charAt(d++)))>>2,i=(3&l)<<6|(o=this._keyStr.indexOf(t.charAt(d++))),c+=String.fromCharCode(a),64!=l&&(c+=String.fromCharCode(r)),64!=o&&(c+=String.fromCharCode(i));return c=e._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",a=0;a<e.length;a++){var r=e.charCodeAt(a);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",a=0,r=0,i=0;a<e.length;)if((r=e.charCodeAt(a))<128)t+=String.fromCharCode(r),a++;else if(r>191&&r<224)i=e.charCodeAt(a+1),t+=String.fromCharCode((31&r)<<6|63&i),a+=2;else{i=e.charCodeAt(a+1);var n=e.charCodeAt(a+2);t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&n),a+=3}return t}};this.base64=e}return this.base64}},{key:"handleCustomFields",value:function(){var e=this,t=0,a={fieldGroup:$("#_render_custom_field_field_group_template").html(),globalSkeleton:$("#_render_custom_field_global_skeleton_template").html(),text:$("#_render_custom_field_text_template").html(),number:$("#_render_custom_field_number_template").html(),email:$("#_render_custom_field_email_template").html(),password:$("#_render_custom_field_password_template").html(),textarea:$("#_render_custom_field_textarea_template").html(),checkbox:$("#_render_custom_field_checkbox_template").html(),radio:$("#_render_custom_field_radio_template").html(),select:$("#_render_custom_field_select_template").html(),image:$("#_render_custom_field_image_template").html(),file:$("#_render_custom_field_file_template").html(),wysiwyg:$("#_render_custom_field_wysiswg_template").html(),repeater:$("#_render_custom_field_repeater_template").html(),repeaterItem:$("#_render_custom_field_repeater_item_template").html(),repeaterFieldLine:$("#_render_custom_field_repeater_line_template").html(),date:$("#_render_custom_field_date_template").html(),time:$("#_render_custom_field_time_template").html(),date_time:$("#_render_custom_field_date_time_template").html(),cycle:$("#_render_custom_field_cycle_template").html()},r=function(e){return l.wysiwyg(e),e},i=function(e){var r=a[e.type],i=$('<div class="lcf-'+e.type+'-wrapper"></div>');i.data("lcf-registered-data",e);var o=null,d=null;switch(e.type){case"text":case"number":case"email":case"date":case"time":case"date-time":case"cycle":case"password":r=(r=r.replace(/__placeholderText__/gi,e.options.placeholderText||"")).replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"textarea":r=(r=(r=r.replace(/__rows__/gi,e.options.rows||3)).replace(/__placeholderText__/gi,e.options.placeholderText||"")).replace(/__value__/gi,e.value||e.options.defaultValue||"");break;case"image":if(r=r.replace(/__value__/gi,e.value||e.options.defaultValue||""),e.value)r=r.replace("data-src","src").replace(/__image__/gi,e.thumb||e.options.defaultValue||"");else{var u=$(r).find("img").attr("data-default");r=(r=r.replace("data-src","src").replace(/__image__/gi,u||e.options.defaultValue||"")).replace('src="'+window.location.origin+'/storage/"','src="'+u+'"')}break;case"file":r=(r=r.replace(/__value__/gi,e.value||e.options.defaultValue||"")).replace(/__url__/gi,e.full_url||e.options.defaultValue||"");break;case"select":return d=$(r),(o=c(e.options.selectChoices)).forEach((function(e){d.append('<option value="'+e[0]+'">'+e[1]+"</option>")})),d.val(l.arrayGet(e,"value",e.options.defaultValue)),i.append(d),i;case"checkbox":o=c(e.options.selectChoices);var s=e.value;return o.forEach((function(e){var t=r.replace(/__value__/gi,e[0]||"");t=(t=t.replace(/__title__/gi,e[1]||"")).replace(/__checked__/gi,-1!=$.inArray(e[0],s)?"checked":""),i.append($(t))})),i;case"radio":o=c(e.options.selectChoices);var _=!1;return o.forEach((function(a){var n=r.replace(/__value__/gi,a[0]||"");n=(n=(n=n.replace(/__id__/gi,e.id+e.slug+t)).replace(/__title__/gi,a[1]||"")).replace(/__checked__/gi,e.value===a[0]?"checked":""),i.append($(n)),e.value===a[0]&&(_=!0)})),!1===_&&i.find("input[type=radio]:first").prop("checked",!0),i;case"repeater":return(d=$(r)).data("lcf-registered-data",e),d.find("> .repeater-add-new-field").html(e.options.buttonLabel||"Add new item"),d.find("> .sortable-wrapper").sortable(),n(e.items,e.value||[],d.find("> .field-group-items")),d;case"wysiwyg":r=r.replace(/__value__/gi,e.value||e.options.defaultValueTextarea||"")}return i.append($(r)),i},n=function(e,t,r){return r.data("lcf-registered-data",e),t.forEach((function(t){var i=r.find("> .ui-sortable-handle").length+1,n=a.repeaterItem;n=n.replace(/__position__/gi,i);var l=$(n);l.data("lcf-registered-data",e),o(e,t,l.find("> .field-line-wrapper > .field-group")),r.append(l)})),r},o=function(e,n,l){return n.forEach((function(e){t++;var n=a.repeaterFieldLine;n=(n=n.replace(/__title__/gi,e.title||"")).replace(/__instructions__/gi,e.instructions||"");var o=$(n),c=i(e);o.data("lcf-registered-data",e),o.find("> .repeater-item-input").append(c),l.append(o),"wysiwyg"===e.type&&r(o.find("> .repeater-item-input .wysiwyg-editor"))})),l},c=function(e){if(!e)return[];var t=[];return e.split("\n").forEach((function(e){var a=e.split(":");a[0]&&a[1]&&(a[0]=a[0].trim(),a[1]=a[1].trim()),t.push(a)})),t};this.$body.on("click",".remove-field-line",(function(e){e.preventDefault();var t=$(e.currentTarget);t.parent().animate({opacity:.1},300,(function(){t.parent().remove()}))})),this.$body.on("click",".collapse-field-line",(function(e){e.preventDefault(),$(e.currentTarget).toggleClass("collapsed-line")})),this.$body.on("click",".repeater-add-new-field",(function(e){e.preventDefault();var a=$.extend(!0,{},$(e.currentTarget).prev(".field-group-items")),r=a.data("lcf-registered-data");t++,n(r,[r],a),Botble.initMediaIntegrate()})),this.CURRENT_DATA.forEach((function(t){var n=a.fieldGroup;n=n.replace(/__title__/gi,t.title||"");var l,o,c=$(n);l=t.items,o=c.find(".meta-boxes-body"),l.forEach((function(e){var t=a.globalSkeleton;t=(t=(t=t.replace(/__type__/gi,e.type||"")).replace(/__title__/gi,e.title||"")).replace(/__instructions__/gi,e.instructions||"");var n=$(t),l=i(e);n.find(".meta-box-wrap").append(l),n.data("lcf-registered-data",e),o.append(n),"wysiwyg"===e.type&&r(n.find(".meta-box-wrap .wysiwyg-editor"))})),c.data("lcf-field-group",t),e.$_UPDATE_TO.append(c)})),Botble.initMediaIntegrate()}},{key:"exportData",value:function(){var e=this,t=function(e){var t=[];return e.each((function(e,r){t.push(a($(r)))})),t},a=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"date":case"time":case"date-time":case"cycle":case"password":case"image":case"file":t.value=e.find("> .meta-box-wrap input").val();break;case"wysiwyg":t.value=l.wysiwygGetContent(e.find("> .meta-box-wrap textarea"));break;case"textarea":t.value=e.find("> .meta-box-wrap textarea").val();break;case"checkbox":t.value=[],e.find("> .meta-box-wrap input:checked").each((function(e,a){t.value.push($(a).val())}));break;case"radio":t.value=e.find("> .meta-box-wrap input:checked").val();break;case"select":t.value=e.find("> .meta-box-wrap select").val();break;case"repeater":t.value=[],e.find("> .meta-box-wrap > .lcf-repeater > .field-group-items > li").each((function(e,a){var i=$(a).find("> .field-line-wrapper > .field-group");t.value.push(r(i.find("> li")))}));break;default:t=null}return t},r=function(e){var t=[];return e.each((function(e,a){var r=$(a);t.push(i(r))})),t},i=function(e){var t=$.extend(!0,{},e.data("lcf-registered-data"));switch(t.type){case"text":case"number":case"email":case"date":case"time":case"date-time":case"cycle":case"password":case"image":case"file":t.value=e.find("> .repeater-item-input input").val();break;case"wysiwyg":t.value=l.wysiwygGetContent(e.find("> .repeater-item-input > .lcf-wysiwyg-wrapper > .wysiwyg-editor"));break;case"textarea":t.value=e.find("> .repeater-item-input textarea").val();break;case"checkbox":t.value=[],e.find("> .repeater-item-input input:checked").each((function(e,a){t.value.push($(a).val())}));break;case"radio":t.value=e.find("> .repeater-item-input input:checked").val();break;case"select":t.value=e.find("> .repeater-item-input select").val();break;case"repeater":t.value=[],e.find("> .repeater-item-input > .lcf-repeater > .field-group-items > li").each((function(e,a){var i=$(a).find("> .field-line-wrapper > .field-group");t.value.push(r(i.find("> li")))}));break;default:t=null}return t};e.$_EXPORT_TO.closest("form").on("submit",(function(){var a;e.$_EXPORT_TO.val(l.jsonEncode((a=[],$("#custom_fields_container").find("> .meta-boxes").each((function(e,r){var i=$(r),n=i.data("lcf-field-group"),l=i.find("> .meta-boxes-body > .meta-box");n.items=t(l),a.push(n)})),a)))}))}}])}();jQuery((function(){new o,document.addEventListener("core-init-resources",(function(){new o}))}))})();